<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.gt.union.mapper.card.UnionBusMemberCardMapper">

	<!-- 通用查询映射结果 -->
	<resultMap id="BaseResultMap" type="com.gt.union.entity.card.UnionBusMemberCard">
		<id column="id" property="id" />
		<result column="createtime" property="createtime" />
		<result column="del_status" property="delStatus" />
		<result column="union_id" property="unionId" />
		<result column="card_id" property="cardId" />
		<result column="bus_id" property="busId" />
		<result column="cardNo" property="cardNo" />
		<result column="phone" property="phone" />
		<result column="member_id" property="memberId" />
		<result column="integral" property="integral" />
	</resultMap>

	<!-- 查询联盟的商家联盟卡积分总和 -->
    <select id="getUnionMemberIntegral" resultType="java.lang.Double">
		SELECT IFNULL(SUM(integral),0)AS integral
		FROM t_union_bus_member_card WHERE bus_id IN(SELECT bus_id from t_union_member WHERE union_id = #{unionId,jdbcType=INTEGER} and del_status = 0)
		AND del_status = 0
	</select>

</mapper>
